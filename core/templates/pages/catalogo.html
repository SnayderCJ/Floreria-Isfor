{% extends 'base.html' %}

{% block content %}
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
    :root {
        --rosa-floral: #ff85a2;
        --rosa-suave: #fff0f3;
        --texto-oscuro: #2d3436;
    }

    body { font-family: 'Poppins', sans-serif; background-color: #fcfcfc; }
    h2, h4 { font-family: 'Playfair Display', serif; color: var(--texto-oscuro); }

    /* Barra Lateral de Categorías */
    .category-sidebar {
        background: white;
        border-radius: 15px;
        padding: 20px;
        box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        position: sticky;
        top: 20px;
    }

    .list-group-item {
        border: none;
        border-radius: 10px !important;
        margin-bottom: 5px;
        transition: all 0.3s ease;
        color: var(--texto-oscuro);
        font-weight: 400;
    }

    .list-group-item:hover {
        background-color: var(--rosa-suave);
        color: var(--rosa-floral);
        padding-left: 25px;
    }

    .list-group-item.active {
        background-color: var(--rosa-floral) !important;
        border: none;
        font-weight: 600;
    }

    /* Cards del Catálogo */
    .card-floral {
        border: none;
        border-radius: 15px;
        transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        overflow: hidden;
        background: white;
    }

    .card-floral:hover {
        transform: translateY(-8px);
        box-shadow: 0 15px 30px rgba(255, 133, 162, 0.15);
    }

    .card-img-container {
        overflow: hidden;
        height: 250px;
    }

    .card-floral img {
        transition: transform 0.6s ease;
        object-fit: cover;
        width: 100%;
        height: 100%;
    }

    .card-floral:hover img {
        transform: scale(1.1);
    }

    .price-tag {
        color: var(--rosa-floral);
        font-size: 1.2rem;
        font-weight: 600;
    }

    .btn-consultar {
        border: 2px solid var(--rosa-floral);
        color: var(--rosa-floral);
        border-radius: 25px;
        font-weight: 600;
        transition: 0.3s;
    }

    .btn-consultar:hover {
        background-color: var(--rosa-floral);
        color: white;
    }

    /* Encabezado del Catálogo */
    .catalog-header {
        padding-bottom: 30px;
        border-bottom: 1px solid #eee;
        margin-bottom: 40px;
    }
</style>

<div class="container py-4">
    <div class="catalog-header text-center">
        <h2 class="display-5">Nuestra Colección</h2>
        <p class="text-muted">Encuentra el detalle perfecto para cada ocasión</p>
    </div>

    <div class="row">
        <aside class="col-lg-3 mb-4">
            <div class="category-sidebar">
                <h4 class="mb-4"><i class="bi bi-filter-left me-2"></i>Filtrar por</h4>
                <div class="list-group">
                    <a href="{% url 'catalogo' %}" 
                       class="list-group-item list-group-item-action {% if not request.GET.categoria %}active{% endif %}">
                        Todos los Arreglos
                    </a>
                    {% for cat in categorias %}
                    <a href="?categoria={{ cat.id }}" 
                       class="list-group-item list-group-item-action {% if request.GET.categoria == cat.id|stringformat:'i' %}active{% endif %}">
                        {{ cat.nombre }}
                    </a>
                    {% endfor %}
                </div>
            </div>
        </aside>

        <main class="col-lg-9">
            <div class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4">
                {% for producto in productos %}
                <div class="col">
                    <div class="card card-floral h-100 shadow-sm">
                        <div class="card-img-container position-relative">
                            <img src="{{ producto.imagen.url }}" alt="{{ producto.nombre }}">
                            <span class="position-absolute top-0 end-0 m-3 badge rounded-pill bg-light text-dark opacity-75">
                                {{ producto.categoria.nombre }}
                            </span>
                        </div>
                        <div class="card-body p-4 text-center">
                            <h5 class="card-title mb-2">{{ producto.nombre }}</h5>
                            <p class="price-tag mb-3">${{ producto.precio_base }}</p>
                            <div class="d-grid">
                                <a href="{% url 'detalle' producto.id %}" class="btn btn-consultar">
                                    Ver Detalles
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                {% empty %}
                <div class="col-12 text-center py-5">
                    <i class="bi bi-flower1 display-1 text-muted"></i>
                    <p class="mt-3 fs-5 text-muted">No encontramos arreglos en esta categoría por ahora.</p>
                </div>
                {% endfor %}
            </div>
        </main>
    </div>
</div>
{% endblock %}